<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Medical AI: Detecting Pneumonia (feat. Covid-19) | Sehyun Choi</title> <meta name="author" content="Sehyun Choi"> <meta name="description" content="AI Lab Korea Open Lab 8th Research"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/syncdoth/jekyll-pygments-themes@master/onedark.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%91%F0%9F%8F%BB%E2%80%8D%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="syncdoth.github.io/projects/eagle_eye/"> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Sehyun </span>Choi</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/courseworks/">courseworks</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Medical AI: Detecting Pneumonia (feat. Covid-19)</h1> <p class="post-description">AI Lab Korea Open Lab 8th Research</p> </header> <article> <p>Since this project is very well documented in the official website, I will only leave a link to the project here.</p> <p><a href="https://www.ai-lab.kr/opens/601005bf7f1e709c2c2d78ac" rel="external nofollow noopener" target="_blank">ai-lab.kr/opens/eagle-eye</a></p> <h3 id="rough-intro">Rough Intro</h3> <ul> <li>Developed a model to detect pneumonia regions from chest X-Ray images.</li> <li>Current research direction in the field is either of 2 directions: <ol> <li>Detect the region of pneumonia inside the image</li> <li>Given a X Ray image, classify which type (the source of the disease) of pneumonia the patient has</li> </ol> </li> <li>We thought, why not both?</li> </ul> <h3 id="problem">Problem</h3> <p>The main problem was data scarcity. To train detection model, we need region of interest labeled, called bounding boxes of the object, which, in our case, is the location of the infection. For such data, we could find them from past kaggle challenges hosted by <a href="https://www.kaggle.com/nih-chest-xrays/data" rel="external nofollow noopener" target="_blank">NIH</a> or <a href="e.com/c/rsna-pneumonia-detection-challenge">RSNA</a>. However, these datasets do not contain information of source of infection: so fine-grained classification cannot be performed.</p> <p>There exists other line of datasets, which include specific types of pneumonias and chest X Ray images (including Covid). However, these datasets are targeted towards the calssification problem, and no bounding box informations are included.</p> <p>-&gt; we had to come up with some solution to utilize both types of dataset!</p> <h3 id="solution">Solution</h3> <p>The solution was to use two different models: <strong>One Detection, One Classification</strong>, and use them to complement each other!</p> <p>The idea was like this: train Detection model on NIH and RSNA dataset. Then, train Classification model on the datasets including fine-grained information. Then,</p> <ol> <li> <p>Use the classification model to infer the types of pneumonia in NIH and RSNA dataset images, and use them to fine tune the Detection Model.</p> <p><img src="/assets/img/eagle-eye/first.png" alt="alt text"></p> </li> <li> <p>After making detection boxed with the detection model, use classification model to further classify each box.</p> <p><img src="/assets/img/eagle-eye/second.png" alt="alt text"></p> </li> </ol> <p>First method is inspired from a semi supervised learning methid called <strong>pseudo labeling</strong>. Although our method is not perfectly in line with this method, but the concept is similar in that using the model output to make use of unlabeled data.</p> <p>The second method is a more popular method used in various industries specializing in CV: most of the time, they make use of YOLO based models for real time services. However, these models sacrifice accuracy for speed, so to further improve their accuracy, they train a separate classifier to aid the predictions of YOLO model.</p> <h3 id="results">Results</h3> <p><img src="/assets/img/eagle-eye/third.png" alt="alt text"></p> <p>The final results can be visulaized as above. Our mAP score was around 0.32 with the second approach: this is on par with other detection model performances, which only focuses on the existence of the pneumonia. Therefore, our model can be considered to have some meaningful contributions in the field by introducing a <strong>complementary model training pipleline</strong> for making use of heterogenous dataset for fine-grained pneumonia detection task.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2023 Sehyun Choi. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 12, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>